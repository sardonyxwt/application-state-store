!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("store",[],e):"object"==typeof exports?exports.store=e():t.store=e()}("undefined"!=typeof self?self:this,function(){return function(t){function e(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var n={};return e.m=t,e.c=n,e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:r})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=0)}([function(t,e,n){"use strict";function r(t,e,n){if(void 0===t&&(t=p.uniqueId("scope")),void 0===e&&(e=null),void 0===n&&(n=[]),t in y)throw new Error("Scope name must unique");var r=new h(t,e,n);return y[t]=r,n.forEach(function(t){return t.postSetup(r)}),l&&l.onCreate(r),r}function o(t,e,n){if(void 0===n&&(n=[]),t in e)throw new Error("Scope name must unique");var r=e.map(function(t){return"string"==typeof t?i(t):t}).filter(function(t,e,n){return t&&n.indexOf(t)===e});if(r.length<2)throw new Error("Compose scopes length must be greater than one");var o=new d(t,r,n);return e[t]=o,n.forEach(function(t){return t.postSetup(o)}),l&&l.onCreate(o),o}function i(t){if(!y[t])throw new Error("Scope with name "+t+" not present");return y[t]}function u(){var t={};return Object.getOwnPropertyNames(y).forEach(function(e){t[e]=y[e].getState()}),t}function c(t){l=t}var s=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),a=this&&this.__assign||Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t};Object.defineProperty(e,"__esModule",{value:!0});var f=n(1),p=n(2),l=null,h=function(){function t(t,e,n){this.name=t,this.state=e,this.isFrozen=!1,this.actionQueue=[],this.actions={},this.middleware=[],this.listeners={},this.middleware=n.slice(),this.middleware.reverse()}return t.prototype.registerAction=function(t,e){if(this.isFrozen)throw new Error("This scope is locked you can't add new action.");if(t in this.actions)throw new Error("Action name is duplicate in scope "+this.name);this.actions[t]=e,l&&l.onChange(this)},t.prototype.dispatch=function(t,e){var n=this,r=this.actions[t];if(!r)throw new Error("This action not exists "+t);e&&"object"==typeof e&&f.deepFreeze(e);var o,i=function(){if(n.actionQueue.shift(),n.actionQueue.length>0){(0,n.actionQueue[0])()}};return new Promise(function(t,i){var u=0===n.actionQueue.length,c=function(){o=n.getState(),n.middleware.forEach(function(t){return r=t.appendActionMiddleware(r)}),r(o,e,t,i)};n.actionQueue.push(c),u&&c()}).then(function(r){f.deepFreeze(r);var u={oldState:o,newState:r,scopeName:n.name,actionName:t,props:e};return Object.getOwnPropertyNames(n.listeners).forEach(function(t){return n.listeners[t](u)}),n.state=r,l&&(l.onAction(u),l.onChange(n)),i(),r},function(r){var u={reason:r,oldState:o,scopeName:n.name,actionName:t,props:e};throw l&&l.onActionError(u),i(),u})},t.prototype.subscribe=function(t,e){var n=this,r=[];Array.isArray(e)?r.push.apply(r,e):"string"==typeof e&&r.push(e),r.forEach(function(t){if(!(t in n.actions))throw new Error("Action ("+t+") not present in scope.")});var o=p.uniqueId("listener");return this.listeners[o]=function(e){var n=-1!==r.findIndex(function(t){return t===e.actionName});(0===r.length||n)&&t(e)},o},t.prototype.synchronize=function(t,e,n){return t[e]=this.getState(),this.subscribe(function(n){var r=n.newState;t[e]=r},n)},t.prototype.unsubscribe=function(t){return delete this.listeners[t]},t.prototype.lock=function(){this.isFrozen=!0,l&&l.onChange(this)},t.prototype.isLocked=function(){return this.isFrozen},t.prototype.getState=function(){return this.state},t.prototype.getSupportActions=function(){return Object.getOwnPropertyNames(this.actions)},t}(),d=function(t){function e(e,n,r){var o=t.call(this,e,{},r)||this;if(o.name=e,o.scopes=n,o.isLocked())throw new Error("You can not use middleware that lock scope to create a composite scope.");var i=[];return n.forEach(function(t){i=i.concat(t.getSupportActions()),t.lock(),t.subscribe(function(e){var n=e.actionName,r=e.props,i=e.oldState,u=o.getState();Object.getOwnPropertyNames(o.listeners).forEach(function(e){return o.listeners[e]({oldState:a({},u,(c={},c[t.name]=i,c)),newState:u,scopeName:t.name,actionName:n,props:r});var c})})}),i=i.filter(function(t,e,n){return n.indexOf(t)===e}),i.forEach(function(t){return o.registerAction(t,function(e,r,i,u){var c=n.filter(function(e){return e.getSupportActions().findIndex(function(e){return e===t})>=0}).map(function(e){return e.dispatch(t,r)});Promise.all(c).then(function(){return i(o.getState())}).catch(u)})}),o.lock(),o}return s(e,t),e.prototype.getState=function(){var t={};return this.scopes.forEach(function(e){return t[e.name]=e.getState()}),t},e}(h),y={};e.createScope=r,e.composeScope=o,e.getScope=i,e.getState=u,e.setStoreDevTool=c,e.ROOT_SCOPE=r("rootScope",{})},function(t,e,n){!function(e,n){t.exports=n()}("undefined"!=typeof self&&self,function(){return function(t){function e(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var n={};return e.m=t,e.c=n,e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:r})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=3)}({3:function(t,e,n){"use strict";function r(t){return Object.getOwnPropertyNames(t).forEach(function(e){var n=t[e];"object"==typeof n&&null!==n&&r(n)}),Object.freeze(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.deepFreeze=r}})})},function(t,e,n){!function(e,n){t.exports=n()}("undefined"!=typeof self&&self,function(){return function(t){function e(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var n={};return e.m=t,e.c=n,e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:r})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=1)}([,function(t,e,n){"use strict";function r(t){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=[];n.length<t;)n.push(e.charAt(Math.floor(Math.random()*e.length)));return n}function o(t,e){void 0===t&&(t=""),void 0===e&&(e=!1),i[t]?++i[t]:i[t]=1;var n=t+i[t];return e&&(n=n+"-"+r(8).join("")),n}Object.defineProperty(e,"__esModule",{value:!0});var i={};e.generateSeed=r,e.uniqueId=o}])})}])});
//# sourceMappingURL=state-store.min.js.map