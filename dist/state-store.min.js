!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("store",[],t):"object"==typeof exports?exports.store=t():e.store=t()}(window,function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}([function(e,t,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},o=this&&this.__spreadArrays||function(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var i=arguments[t],a=0,c=i.length;a<c;a++,o++)n[o]=i[a];return n};Object.defineProperty(t,"__esModule",{value:!0});var i,a,c,s=r(1),u=r(2);!function(e){e.GETTER="GETTER",e.SETTER="SETTER",e.FUNCTION="FUNCTION"}(i=t.ScopeMacroType||(t.ScopeMacroType={})),function(e){e.REGISTER_MACRO="REGISTER_MACRO",e.REGISTER_ACTION="REGISTER_ACTION",e.LOCK="LOCK"}(a=t.ScopeChangeEventType||(t.ScopeChangeEventType={})),function(e){e.CREATE_SCOPE="CREATE_SCOPE",e.LOCK="LOCK"}(c=t.StoreChangeEventType||(t.StoreChangeEventType={}));var f=new Map,l={onCreateStore:function(){return null},onChangeStore:function(){return null},onCreateScope:function(){return null},onChangeScope:function(){return null},onAction:function(){return null},onActionError:function(){return null},onActionListenerError:function(){return null}};t.RESET_SCOPE_ACTION="_reset",t.RESTORE_SCOPE_ACTION="_restore";var p=function(){function e(e,r){var n=this;this._isActionInProgress=!1,this._isActionDispatchAvailable=!0,this._actions=new Map,this._listeners=new Map,this._contextEvents=null,this._listenerIdGenerator=u.createUniqueIdGenerator("ScopeListener");var i=r.name,a=r.initState,c=r.middleware,s=r.isImmutabilityEnabled,f=r.isSubscribedMacroAutoCreateEnabled,l=r.isFrozen;this.store=e,this.name=i,this.isImmutabilityEnabled=s,this.isSubscribedMacroAutoCreateEnabled=f,this._state=a,this._initState=a,this._middleware=o(c).reverse(),this.registerAction(t.RESET_SCOPE_ACTION,function(){return n._initState}),this.registerAction(t.RESTORE_SCOPE_ACTION,function(e,t){return n._initState=t,t}),this._isFrozen=l}return Object.defineProperty(e.prototype,"isLocked",{get:function(){return this._isFrozen},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isActionDispatchAvailable",{get:function(){return this._isActionDispatchAvailable},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"state",{get:function(){return this._state},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"context",{get:function(){return this._context},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"supportActions",{get:function(){return Array.from(this._actions.keys())},enumerable:!0,configurable:!0}),e.prototype.registerAction=function(e,t,r){var n=this;if(this._isFrozen)throw new Error("This scope is locked you can't add new action.");if(this._actions.has(e)||this.isSubscribedMacroAutoCreateEnabled&&e in this)throw new Error("Action name "+e+" is duplicate or reserved in scope "+this.name+".");this._actions.set(e,t);var o=function(t,o){var i=n.dispatch(e,t,o);return r?r(i,t):i};if(this.isSubscribedMacroAutoCreateEnabled){var i="on"+(e.charAt(0).toUpperCase()+e.slice(1));this.registerMacro(i,function(t,r){return n.subscribe(r,[e])})}return this[e]=o,l.onChangeScope(this,{type:a.REGISTER_ACTION,actionName:e}),o},e.prototype.registerMacro=function(e,t,r){var n=this;if(void 0===r&&(r=i.FUNCTION),!t)throw new Error("Macro cannot be null or undefined.");if(this._isFrozen)throw new Error("This scope is locked you can't add new macro.");if(e in this&&("function"==typeof n[e]||r===i.FUNCTION||r===i.GETTER&&Object.getOwnPropertyDescriptor(this,e).get||r===i.SETTER&&Object.getOwnPropertyDescriptor(this,e).set))throw new Error("Macro name "+e+" is reserved in scope "+this.name+".");var o=function(e){return t(n._state,e)};switch(r){case i.FUNCTION:this[e]=o;break;case i.GETTER:Object.defineProperty(this,e,{get:o,configurable:!0,enumerable:!0});break;case i.SETTER:Object.defineProperty(this,e,{set:o,configurable:!0,enumerable:!0})}l.onChangeScope(this,{type:a.REGISTER_MACRO,macroName:e,macroType:r})},e.prototype.dispatch=function(e,t,r){var o=this;void 0===r&&(r=!0);var i=this._actions.get(e);if(!i)throw new Error("This action not exists "+e);if(!this._isActionDispatchAvailable)throw new Error("Now action dispatch not available. Other action spreads.");this.isImmutabilityEnabled&&t&&"object"==typeof t&&s.deepFreeze(t),this._middleware.forEach(function(e){return i=e.appendActionMiddleware(i)});var a=this._isActionInProgress?this._context:this._state,c=function(r){return{reason:r,oldState:a,scopeName:o.name,actionName:e,props:t}},u=function(i){o.isImmutabilityEnabled&&i&&"object"==typeof t&&s.deepFreeze(i);var u={oldState:a,newState:i,scopeName:o.name,storeName:o.store.name,actionName:e,props:t};if(o._isActionInProgress)return r&&(o._contextEvents?o._contextEvents.push(u):o._contextEvents=[u]),o._context=i,i;o._context=null,o._state=i,o._contextEvents&&(u.childrenEvents=o._contextEvents.map(function(e){return n(n({},e),{parentEvent:u})})),o._contextEvents=null,o._isActionDispatchAvailable=!1;var f=function(e){l.onAction(e),o._listeners.forEach(function(t){try{t&&t(e)}catch(e){l.onActionListenerError(c(e))}})};return r&&(u.childrenEvents&&u.childrenEvents.forEach(f),f(u)),o._isActionDispatchAvailable=!0,i},f=function(e){var t=c(e);return o._isActionInProgress||l.onActionError(t),t};if(this._isActionInProgress)try{return u(i(a,t))}catch(e){throw f(e)}try{this._isActionInProgress=!0,this._context=a;var p=i(a,t);return this._isActionInProgress=!1,u(p)}catch(e){throw this._isActionInProgress=!1,f(e)}},e.prototype.subscribe=function(e,t){var r=this;void 0===t&&(t=[]),t.forEach(function(e){if(!r._actions.has(e))throw new Error("Action ("+e+") not present in scope.")});var n=this._listenerIdGenerator();return this._listeners.set(n,0===t.length?e:function(r){-1!==t.findIndex(function(e){return e===r.actionName})&&e(r)}),Object.assign(function(){return r.unsubscribe(n)},{listenerId:n})},e.prototype.unsubscribe=function(e){return this._listeners.delete(e)},e.prototype.lock=function(){this._isFrozen=!0,l.onChangeScope(this,{type:a.LOCK})},e.prototype.reset=function(e){return this.dispatch(t.RESET_SCOPE_ACTION,null,e)},e.prototype.restore=function(e,r){return this.dispatch(t.RESTORE_SCOPE_ACTION,e,r)},e}(),h=function(){function e(e){this._scopes=new Map,this._scopeNameGenerator=u.createUniqueIdGenerator("Scope"),this.name=e.name,this._isFrozen=e.isFrozen}return Object.defineProperty(e.prototype,"isLocked",{get:function(){return this._isFrozen},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"state",{get:function(){var e={};return this._scopes.forEach(function(t){e[t.name]=t.state}),e},enumerable:!0,configurable:!0}),e.prototype.createScope=function(e){if(void 0===e&&(e={}),this._isFrozen)throw new Error("This Store is locked you can't add new scope.");var t=e.name,r=void 0===t?this._scopeNameGenerator():t,n=e.initState,o=void 0===n?null:n,i=e.middleware,a=void 0===i?[]:i,s=e.isImmutabilityEnabled,u=void 0!==s&&s,f=e.isSubscribedMacroAutoCreateEnabled,h=void 0!==f&&f,d=e.isFrozen,b=void 0!==d&&d;if(this._scopes.has(r))throw new Error("Scope name must unique");var y=new p(this,{name:r,initState:o,middleware:a,isImmutabilityEnabled:u,isSubscribedMacroAutoCreateEnabled:h,isFrozen:b});return this._scopes.set(r,y),a.forEach(function(e){return e.postSetup(y)}),l.onCreateScope(y),l.onChangeStore(this,{type:c.CREATE_SCOPE,scopeName:r}),y},e.prototype.getScope=function(e){return this._scopes.get(e)},e.prototype.hasScope=function(e){return this._scopes.has(e)},e.prototype.lock=function(){this._isFrozen=!0,this._scopes.forEach(function(e){return e.lock()}),l.onChangeStore(this,{type:c.LOCK})},e.prototype.reset=function(e){this._scopes.forEach(function(t){return t.reset(e)})},e.prototype.restore=function(e){var t=this;e.forEach(function(e,r){return t.getScope(r).restore(e)})},e}();function d(e){return f.has(e)}t.isStoreExist=d,t.createStore=function(e){var t=e.name,r=e.isFrozen,n=void 0!==r&&r;if(d(t))throw new Error("Store name must unique");var o=new h({name:t,isFrozen:n});return f.set(t,o),l.onCreateStore(o),o},t.getStore=function(e){return f.get(e)},t.getState=function(){var e={};return f.forEach(function(t){e[t.name]=t.state}),e},t.setStoreDevTool=function(e){Object.assign(l,e)}},function(e,t,r){window,e.exports=function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=1)}([,function(e,t,r){"use strict";var n=this&&this.__spreadArrays||function(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var i=arguments[t],a=0,c=i.length;a<c;a++,o++)n[o]=i[a];return n};Object.defineProperty(t,"__esModule",{value:!0}),t.deepFreeze=function e(t){return Object.getOwnPropertyNames(t).forEach(function(r){var n=t[r];"object"==typeof n&&null!==n&&e(n)}),Object.freeze(t)},t.flatten=function(e){var t={};return function e(r,n){if(Object(r)!==r)t[n]=r;else if(Array.isArray(r))if(0===r.length)t[n]=[];else for(var o=0;o<r.length;o++)e(r[o],n?n+"."+o:""+o);else{var i=Object.getOwnPropertyNames(r);0!==i.length?i.forEach(function(t){return e(r[t],n?n+"."+t:t)}):t[n]={}}}(e,""),t},t.unflatten=function(e){if(Object(e)!==e||Array.isArray(e))return e;var t,r,n,o,i={};return Object.getOwnPropertyNames(e).forEach(function(a){t=i,r="",n=a.split(".");for(var c=0;c<n.length;c++)o=!isNaN(parseInt(n[c],10)),t=t[r]||(t[r]=o?[]:{}),r=n[c];t[r]=e[a]}),i[""]},t.stringifyValue=function(e){return null==e?"":"number"==typeof e?""+e:"object"==typeof e?JSON.stringify(e):e},t.resolveValue=function(e,t){for(var r=t.split(/[.\[\]]/).filter(function(e){return""!==e}),n=e,o=0;o<r.length;o++){if(!n||"object"!=typeof n){n=void 0;break}n=n[r[o]]}return n},t.clone=function(e){return Object.assign(Object.create(Object.getPrototypeOf(e)),e)},t.cloneArray=function(e){return e.map(t.clone)},t.cloneArrays=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var n=[];return e.forEach(function(e){return e.forEach(function(e){return n.push(t.clone(e))})}),n},t.copyArray=function(e){return n(e)},t.copyArrays=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=[];return e.forEach(function(e){return r.push.apply(r,e)}),r},t.resolveArray=function(e){return Array.isArray(e)?e:[e]},t.arrayFrom=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return t.copyArrays.apply(void 0,e.map(t.resolveArray))},t.saveToArray=function(e,t,r){void 0===r&&(r=function(e,t){return e===t});var n=e.findIndex(function(e,n,o){return r(e,t,n,o)});-1!==n?e[n]=t:e.push(t)},t.deleteFromArray=function(e,t){var r=e.findIndex(t);-1!==r&&e.splice(r,1)}}])},function(e,t,r){window,e.exports=function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.generateSalt=function(e,t){void 0===e&&(e=16),void 0===t&&(t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789");for(var r="";r.length<e;)r+=t.charAt(Math.floor(Math.random()*t.length));return r},t.generateUUID=function(){return t.generateSalt(4)+"-"+t.generateSalt(4)+"-"+t.generateSalt(4)+"-"+t.generateSalt(4)},t.createUniqueIdGenerator=function(e){var r=0,n=e+":"+t.generateUUID();return function(){return n+":"+ ++r}}}])}])});
//# sourceMappingURL=state-store.min.js.map