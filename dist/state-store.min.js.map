{"version":3,"sources":["webpack://store/webpack/universalModuleDefinition","webpack://store/webpack/bootstrap","webpack://store/./src/index.ts","webpack://store/./node_modules/@sardonyxwt/utils/object/object.min.js","webpack://store/./node_modules/@sardonyxwt/utils/generator/generator.min.js"],"names":["root","factory","exports","module","define","amd","window","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","ScopeMacroType","ScopeChangeEventType","StoreChangeEventType","object_1","generator_1","stores","storeDevTool","onCreateStore","onChangeStore","onCreateScope","onChangeScope","onAction","onActionError","onActionListenerError","ScopeImpl","store","config","this","_isActionInProgress","_isActionDispatchAvailable","_actions","_listeners","_listenerIdGenerator","createUniqueIdGenerator","initState","middleware","isSubscribeMacroAutoCreateEnable","isFrozen","_name","_initState","_state","_store","_middleware","slice","reverse","_isSubscribeMacroAutoCreateEnable","_isFrozen","_context","getOwnPropertyNames","registerAction","actionName","action","transformer","_this","actionResult","Error","actionDispatcher","props","emitEvent","dispatch","subscriberMacroName","charAt","toUpperCase","registerMacro","state","listener","subscribe","type","REGISTER_ACTION","macroName","macro","macroType","FUNCTION","GETTER","getOwnPropertyDescriptor","SETTER","set","macroFunc","configurable","REGISTER_MACRO","deepFreeze","forEach","appendActionMiddleware","oldState","buildScopeError","reason","scopeName","onFulfilled","newState","event","storeName","_contextEvents","push","childrenEvents","map","contextEvent","__assign","parentEvent","dispatchEvent","onRejected","error","e","actionNames","Array","isArray","apply","listenerId","length","findIndex","assign","unsubscribe","id","lock","LOCK","reset","StoreImpl","_scopeNameGenerator","_scopes","scope","it","createScope","_a","_b","_c","_d","_e","find","postSetup","CREATE_SCOPE","getScope","createStore","getStore","getState","setStoreDevTool","devTool","self","default","2","freeze","flatten","f","unflatten","u","split","isNaN","parseInt","stringifyValue","JSON","stringify","generateSalt","Math","floor","random","generateUUID"],"mappings":"CAAA,SAAAA,EAAAC,GACA,iBAAAC,SAAA,iBAAAC,OACAA,OAAAD,QAAAD,IACA,mBAAAG,eAAAC,IACAD,OAAA,WAAAH,GACA,iBAAAC,QACAA,QAAA,MAAAD,IAEAD,EAAA,MAAAC,IARA,CASCK,OAAA,WACD,mBCTA,IAAAC,EAAA,GAGA,SAAAC,EAAAC,GAGA,GAAAF,EAAAE,GACA,OAAAF,EAAAE,GAAAP,QAGA,IAAAC,EAAAI,EAAAE,GAAA,CACAC,EAAAD,EACAE,GAAA,EACAT,QAAA,IAUA,OANAU,EAAAH,GAAAI,KAAAV,EAAAD,QAAAC,IAAAD,QAAAM,GAGAL,EAAAQ,GAAA,EAGAR,EAAAD,QA0DA,OArDAM,EAAAM,EAAAF,EAGAJ,EAAAO,EAAAR,EAGAC,EAAAQ,EAAA,SAAAd,EAAAe,EAAAC,GACAV,EAAAW,EAAAjB,EAAAe,IACAG,OAAAC,eAAAnB,EAAAe,EAAA,CAA0CK,YAAA,EAAAC,IAAAL,KAK1CV,EAAAgB,EAAA,SAAAtB,GACA,oBAAAuB,eAAAC,aACAN,OAAAC,eAAAnB,EAAAuB,OAAAC,YAAA,CAAwDC,MAAA,WAExDP,OAAAC,eAAAnB,EAAA,cAAiDyB,OAAA,KAQjDnB,EAAAoB,EAAA,SAAAD,EAAAE,GAEA,GADA,EAAAA,IAAAF,EAAAnB,EAAAmB,IACA,EAAAE,EAAA,OAAAF,EACA,KAAAE,GAAA,iBAAAF,QAAAG,WAAA,OAAAH,EACA,IAAAI,EAAAX,OAAAY,OAAA,MAGA,GAFAxB,EAAAgB,EAAAO,GACAX,OAAAC,eAAAU,EAAA,WAAyCT,YAAA,EAAAK,UACzC,EAAAE,GAAA,iBAAAF,EAAA,QAAAM,KAAAN,EAAAnB,EAAAQ,EAAAe,EAAAE,EAAA,SAAAA,GAAgH,OAAAN,EAAAM,IAAqBC,KAAA,KAAAD,IACrI,OAAAF,GAIAvB,EAAA2B,EAAA,SAAAhC,GACA,IAAAe,EAAAf,KAAA2B,WACA,WAA2B,OAAA3B,EAAA,SAC3B,WAAiC,OAAAA,GAEjC,OADAK,EAAAQ,EAAAE,EAAA,IAAAA,GACAA,GAIAV,EAAAW,EAAA,SAAAiB,EAAAC,GAAsD,OAAAjB,OAAAkB,UAAAC,eAAA1B,KAAAuB,EAAAC,IAGtD7B,EAAAgC,EAAA,GAIAhC,IAAAiC,EAAA,2TClFA,IA4DYC,EAqKAC,EAMAC,EAvOZC,EAAArC,EAAA,GACAsC,EAAAtC,EAAA,IA2DA,SAAYkC,GACVA,EAAA,gBACAA,EAAA,gBACAA,EAAA,oBAHF,CAAYA,EAAAxC,EAAAwC,iBAAAxC,EAAAwC,eAAc,KAqK1B,SAAYC,GACVA,EAAA,gCACAA,EAAA,kCACAA,EAAA,YAHF,CAAYA,EAAAzC,EAAAyC,uBAAAzC,EAAAyC,qBAAoB,KAMhC,SAAYC,GACVA,EAAA,4BACAA,EAAA,YAFF,CAAYA,EAAA1C,EAAA0C,uBAAA1C,EAAA0C,qBAAoB,KA2IhC,IAAMG,EAAkB,GAClBC,EAA6B,CACjCC,cAAe,WAAM,aACrBC,cAAe,WAAM,aACrBC,cAAe,WAAM,aACrBC,cAAe,WAAM,aACrBC,SAAU,WAAM,aAChBC,cAAe,WAAM,aACrBC,sBAAuB,WAAM,cAG/BC,EAAA,WAiBE,SAAAA,EAAYC,EAAcC,GATlBC,KAAAC,qBAA+B,EAC/BD,KAAAE,4BAAsC,EAGtCF,KAAAG,SAAmD,GACnDH,KAAAI,WAAkD,GAEzCJ,KAAAK,qBAAuBlB,EAAAmB,wBAAwB,iBAGvD,IAAAhD,EAAAyC,EAAAzC,KAAMiD,EAAAR,EAAAQ,UAAWC,EAAAT,EAAAS,WAAYC,EAAAV,EAAAU,iCAAkCC,EAAAX,EAAAW,SACtEV,KAAKW,MAAQrD,EACb0C,KAAKY,WAAcL,EACnBP,KAAKa,OAASN,EACdP,KAAKc,OAAShB,EAEdE,KAAKe,YAAkBP,EAAUQ,QAAEC,UACnCjB,KAAKkB,kCAAoCT,EACzCT,KAAKmB,UAAYT,EAkRrB,OA/QEjD,OAAAC,eAAImC,EAAAlB,UAAA,OAAI,KAAR,WACE,OAAOqB,KAAKW,uCAGdlD,OAAAC,eAAImC,EAAAlB,UAAA,WAAQ,KAAZ,WACE,OAAOqB,KAAKmB,2CAGd1D,OAAAC,eAAImC,EAAAlB,UAAA,4BAAyB,KAA7B,WACE,OAAOqB,KAAKE,4DAGdzC,OAAAC,eAAImC,EAAAlB,UAAA,mCAAgC,KAApC,WACE,OAAOqB,KAAKkB,mEAGdzD,OAAAC,eAAImC,EAAAlB,UAAA,QAAK,KAAT,WACE,OAAOqB,KAAKa,wCAGdpD,OAAAC,eAAImC,EAAAlB,UAAA,UAAO,KAAX,WACE,OAAOqB,KAAKoB,0CAGd3D,OAAAC,eAAImC,EAAAlB,UAAA,QAAK,KAAT,WACE,OAAOqB,KAAKc,wCAGdrD,OAAAC,eAAImC,EAAAlB,UAAA,iBAAc,KAAlB,WACE,OAAOlB,OAAO4D,oBAAoBrB,KAAKG,2CAGzCN,EAAAlB,UAAA2C,eAAA,SACEC,EACAC,EACAC,GAHF,IAAAC,EAAA1B,KAME,QAHA,IAAAyB,MAAA,SACIE,GAAgB,OAAkBA,KAEjCF,EACH,MAAM,IAAIG,MAAM,4CAElB,GAAI5B,KAAKmB,UACP,MAAM,IAAIS,MAAM,kDAElB,GAAIL,KAAcvB,KAAKG,UAAaH,KAAKkB,mCAAqCK,KAAcvB,KAC1F,MAAM,IAAI4B,MAAM,eAAeL,EAAU,sCAAsCvB,KAAKW,MAAK,KAE3FX,KAAKG,SAASoB,GAAcC,EAE5B,IAAMK,EAAmB,SAACC,EAAeC,GACvC,OAAON,EAAYC,EAAKM,SAAST,EAAYO,EAAOC,GAAYD,IAGlE,GAAI9B,KAAKkB,kCAAmC,CAC1C,IAIMe,EAAsB,MAHnBV,EAAWW,OAAO,GAAGC,cAAgBZ,EAAWP,MAAM,IAK/DhB,KAAKoC,cAAcH,EAAqB,SAACI,EAAOC,GAC9C,OAAOZ,EAAKa,UAAUD,EAAUf,KAQpC,OAJAvB,KAAKuB,GAAcM,EAEnBxC,EAAaI,cAAcO,KAAM,CAACwC,KAAMxD,EAAqByD,gBAAiBlB,WAAUA,IAEjFM,GAGThC,EAAAlB,UAAAyD,cAAA,SACEM,EACAC,EACAC,GAHF,IAAAlB,EAAA1B,KAKE,QAFA,IAAA4C,MAA4B7D,EAAe8D,WAEtCF,EACH,MAAM,IAAIf,MAAM,sCAElB,GAAI5B,KAAKmB,UACP,MAAM,IAAIS,MAAM,iDAKlB,GAHqBc,KAAa1C,OACqC,mBAApB0B,EAAKgB,IAIjDE,IAAc7D,EAAe8D,UAC5BD,IAAc7D,EAAe+D,QAAUrF,OAAOsF,yBAAyB/C,KAAM0C,GAAW9E,KACxFgF,IAAc7D,EAAeiE,QAAUvF,OAAOsF,yBAAyB/C,KAAM0C,GAAWO,KAC9F,MAAM,IAAIrB,MAAM,cAAcc,EAAS,yBAAyB1C,KAAKW,MAAK,KAE5E,IAAMuC,EAAY,SAACpB,GACjB,OAAOa,EAAMjB,EAAKb,OAAQiB,IAE5B,OAAQc,GACN,KAAK7D,EAAe8D,SAClB7C,KAAK0C,GAAaQ,EAClB,MACF,KAAKnE,EAAe+D,OAClBrF,OAAOC,eAAesC,KAAM0C,EAAW,CAAC9E,IAAKsF,EAAWC,cAAc,EAAMxF,YAAY,IACxF,MACF,KAAKoB,EAAeiE,OAClBvF,OAAOC,eAAesC,KAAM0C,EAAW,CAACO,IAAKC,EAAWC,cAAc,EAAMxF,YAAY,IAI5F0B,EAAaI,cAAcO,KAAM,CAACwC,KAAMxD,EAAqBoE,eAAgBV,UAASA,EAAEE,UAASA,KAGnG/C,EAAAlB,UAAAqD,SAAA,SAAST,EAAoBO,EAAQC,GAArC,IAAAL,EAAA1B,UAAqC,IAAA+B,OAAA,GACnC,IAAIP,EAA8BxB,KAAKG,SAASoB,GAEhD,IAAKC,EACH,MAAM,IAAII,MAAM,0BAA0BL,GAG5C,IAAKvB,KAAKE,2BACR,MAAM,IAAI0B,MAAM,4DAGdE,GAA0B,iBAAVA,GAClB5C,EAAAmE,WAAWvB,GAGb9B,KAAKe,YAAYuC,QACf,SAAA9C,GAAc,OAAAgB,EAAShB,EAAW+C,uBAAuB/B,KAG3D,IAAMgC,EAAWxD,KAAKC,oBAAsBD,KAAKoB,SAAWpB,KAAKa,OAE3D4C,EAAkB,SAACC,GAAW,OAClCA,OAAMA,EACNF,SAAQA,EACRG,UAAWjC,EAAKf,MAChBY,WAAUA,EACVO,MAAKA,IAGD8B,EAAc,SAAAC,GAClB3E,EAAAmE,WAAWQ,GACX,IAAMC,EAAuB,CAC3BN,SAAQA,EACRK,SAAQA,EACRF,UAAWjC,EAAKf,MAChBoD,UAAWrC,EAAKZ,OAAOxD,KACvBiE,WAAUA,EACVO,MAAKA,GAGP,GAAIJ,EAAKzB,oBAOP,OANI8B,IACFL,EAAKsC,eACDtC,EAAKsC,eAAeC,KAAKH,GACzBpC,EAAKsC,eAAiB,CAACF,IAE7BpC,EAAKN,SAAWyC,EACTA,EAGTnC,EAAKN,SAAW,KAChBM,EAAKb,OAASgD,EAEVnC,EAAKsC,iBACPF,EAAMI,eAAiBxC,EAAKsC,eACzBG,IAAI,SAAAC,GAAgB,OAAAC,EAAA,GAAKD,EAAY,CAAEE,YAAaR,OAGzDpC,EAAKsC,eAAiB,KACtBtC,EAAKxB,4BAA6B,EAElC,IAAMqE,EAAgB,SAACT,GACrBzE,EAAaK,SAASoE,GACtBrG,OAAO4D,oBAAoBK,EAAKtB,YAAYkD,QAAQ,SAAAhF,GAClD,IAAMgE,EAAWZ,EAAKtB,WAAW9B,GACjC,IACMgE,GAAUA,EAASwB,GACvB,MAAOJ,GACPrE,EAAaO,sBAAsB6D,EAAgBC,QAczD,OATI3B,IACE+B,EAAMI,gBACRJ,EAAMI,eAAeZ,QAAQiB,GAE/BA,EAAcT,IAGhBpC,EAAKxB,4BAA6B,EAE3B2D,GAGHW,EAAa,SAAAd,GACjB,IAAMe,EAAQhB,EAAgBC,GAI9B,OAHKhC,EAAKzB,qBACRZ,EAAaM,cAAc8E,GAEtBA,GAGT,GAAIzE,KAAKC,oBACP,IACE,OAAO2D,EAAYpC,EAAOgC,EAAU1B,IACpC,MAAO4C,GACP,MAAMF,EAAWE,GAIrB,IACE1E,KAAKC,qBAAsB,EAC3BD,KAAKoB,SAAWoC,EAChB,IAAM7B,EAAeH,EAAOgC,EAAU1B,GAEtC,OADA9B,KAAKC,qBAAsB,EACpB2D,EAAYjC,GACnB,MAAO+C,GAEP,MADA1E,KAAKC,qBAAsB,EACrBuE,EAAWE,KAIrB7E,EAAAlB,UAAA4D,UAAA,SAAUD,EAA4Bf,GAAtC,IAAAG,EAAA1B,KACQ2E,EAAwB,GAE1BC,MAAMC,QAAQtD,GAChBoD,EAAYV,KAAIa,MAAhBH,EAAoBpD,GACXA,GACToD,EAAYV,KAAK1C,GAGnBoD,EAAYrB,QAAQ,SAAA/B,GAClB,KAAMA,KAAcG,EAAKvB,UACvB,MAAM,IAAIyB,MAAM,WAAWL,EAAU,6BAIzC,IAAMwD,EAAa/E,KAAKK,uBAgBxB,OAfAL,KAAKI,WAAW2E,GAAc,SAAAjB,GAE5B,GAA2B,IAAvBa,EAAYK,OACd,OAAO1C,EAASwB,IAKX,IAFwBa,EAAYM,UACzC,SAAA1D,GAAc,OAAAA,IAAeuC,EAAMvC,cAInCe,EAASwB,IAINrG,OAAOyH,OAAO,WAAM,OAAAxD,EAAKyD,YAAYJ,IAAa,CAACA,WAAUA,KAGtElF,EAAAlB,UAAAwG,YAAA,SAAYC,GACV,cAAcpF,KAAKI,WAAWgF,IAGhCvF,EAAAlB,UAAA0G,KAAA,WACErF,KAAKmB,WAAY,EACjB9B,EAAaI,cAAcO,KAAM,CAACwC,KAAMxD,EAAqBsG,QAG/DzF,EAAAlB,UAAA4G,MAAA,WACEvF,KAAKa,OAASb,KAAKY,YAGvBf,EA5SA,GA8SA2F,EAAA,WAOE,SAAAA,EAAYzF,GAHKC,KAAAyF,oBAAsBtG,EAAAmB,wBAAwB,SAItD,IAAAhD,EAAAyC,EAAAzC,KAAMoD,EAAAX,EAAAW,SACbV,KAAKW,MAAQrD,EACb0C,KAAKmB,UAAYT,EACjBV,KAAK0F,QAAU,GAsEnB,OAnEEjI,OAAAC,eAAI8H,EAAA7G,UAAA,OAAI,KAAR,WACE,OAAOqB,KAAKW,uCAGdlD,OAAAC,eAAI8H,EAAA7G,UAAA,WAAQ,KAAZ,WACE,OAAOqB,KAAKmB,2CAGd1D,OAAAC,eAAI8H,EAAA7G,UAAA,QAAK,KAAT,WACE,IAAM0D,EAAQ,GAId,OAHArC,KAAK0F,QAAQpC,QAAQ,SAAAqC,GACnBtD,EAAMsD,EAAMrI,MAAQqI,EAAMtD,QAErBA,mCAGT5E,OAAAC,eAAI8H,EAAA7G,UAAA,SAAM,KAAV,WACE,OAAOqB,KAAK0F,QAAQvB,IAAI,SAAAyB,GAAM,OAAAA,EAAGtI,wCAGnCkI,EAAA7G,UAAAkH,YAAA,SAAe9F,GACb,QADa,IAAAA,MAAA,IACTC,KAAKmB,UACP,MAAM,IAAIS,MAAM,iDAGhB,IAAAkE,EAAA/F,EAAAzC,YAAA,IAAAwI,EAAA9F,KAAAyF,sBAAAK,EACAC,EAAAhG,EAAAQ,iBAAA,IAAAwF,EAAA,KAAAA,EACAC,EAAAjG,EAAAS,kBAAA,IAAAwF,EAAA,GAAAA,EACAC,EAAAlG,EAAAU,wCAAA,IAAAwF,KACAC,EAAAnG,EAAAW,gBAAA,IAAAwF,KAGF,KADuBlG,KAAK0F,QAAQS,KAAK,SAAAP,GAAM,OAAAA,EAAGtI,OAASA,IAEzD,MAAM,IAAIsE,MAAM,0BAElB,IAAI+D,EAAQ,IAAI9F,EAAaG,KAAM,CACjC1C,KAAIA,EACJiD,UAASA,EACTC,WAAYA,EACZC,iCAAgCA,EAChCC,SAAQA,IAMV,OAJAV,KAAK0F,QAAQzB,KAAK0B,GAClBnF,EAAW8C,QAAQ,SAAA9C,GAAc,OAAAA,EAAW4F,UAAUT,KACtDtG,EAAaG,cAAcmG,GAC3BtG,EAAaE,cAAcS,KAAM,CAACwC,KAAMvD,EAAqBoH,aAAc1C,UAAWrG,IAC/EqI,GAGTH,EAAA7G,UAAA2H,SAAA,SAAiB3C,GACf,IAAMgC,EAAQ3F,KAAK0F,QAAQS,KAAK,SAAAP,GAAM,OAAAA,EAAGtI,OAASqG,IAClD,IAAKgC,EACH,MAAM,IAAI/D,MAAM,mBAAmB+B,EAAS,mCAAmC3D,KAAKW,OAEtF,OAAOgF,GAGTH,EAAA7G,UAAA0G,KAAA,WACErF,KAAKmB,WAAY,EACjBnB,KAAK0F,QAAQpC,QAAQ,SAAAsC,GAAM,OAAAA,EAAGP,SAC9BhG,EAAaE,cAAcS,KAAM,CAACwC,KAAMvD,EAAqBqG,QAG/DE,EAAA7G,UAAA4G,MAAA,WACEvF,KAAK0F,QAAQpC,QAAQ,SAAAsC,GAAM,OAAAA,EAAGL,WAGlCC,EAjFA,GA0FAjJ,EAAAgK,YAAA,SAA4BxG,GAExB,IAAAzC,EAAAyC,EAAAzC,KACAwI,EAAA/F,EAAAW,gBAAA,IAAAoF,KAGF,GADuB1G,EAAO+G,KAAK,SAAAP,GAAM,OAAAA,EAAGtI,OAASA,IAEnD,MAAM,IAAIsE,MAAM,0BAElB,IAAM9B,EAAQ,IAAI0F,EAAU,CAAClI,KAAIA,EAAEoD,SAAQA,IAG3C,OAFAtB,EAAO6E,KAAKnE,GACZT,EAAaC,cAAcQ,GACpBA,GAUTvD,EAAAiK,SAAA,SAAyBzC,GACvB,IAAMjE,EAAQV,EAAO+G,KAAK,SAAAP,GAAM,OAAAA,EAAGtI,OAASyG,IAC5C,IAAKjE,EACH,MAAM,IAAI8B,MAAM,mBAAmBmC,EAAS,gBAE9C,OAAOjE,GAQTvD,EAAAkK,SAAA,WACE,IAAMpE,EAAQ,GAId,OAHAjD,EAAOkE,QAAQ,SAAAxD,GACbuC,EAAMvC,EAAMxC,MAAQwC,EAAMuC,QAErBA,GAQT9F,EAAAmK,gBAAA,SAAgCC,GAC9BlJ,OAAOyH,OAAO7F,EAAcsH,qBCtzBgM,oBAAAC,WAA3JpK,EAAAD,QAA0M,SAAAmI,GAAmB,SAAAzG,EAAAO,GAAc,GAAAX,EAAAW,GAAA,OAAAX,EAAAW,GAAAjC,QAA4B,IAAAiB,EAAAK,EAAAW,GAAA,CAAYzB,EAAAyB,EAAAxB,GAAA,EAAAT,QAAA,IAAqB,OAAAmI,EAAAlG,GAAAtB,KAAAM,EAAAjB,QAAAiB,IAAAjB,QAAA0B,GAAAT,EAAAR,GAAA,EAAAQ,EAAAjB,QAA2D,IAAAsB,EAAA,GAAS,OAAAI,EAAAd,EAAAuH,EAAAzG,EAAAb,EAAAS,EAAAI,EAAAZ,EAAA,SAAAqH,EAAA7G,EAAAW,GAAuCP,EAAAT,EAAAkH,EAAA7G,IAAAJ,OAAAC,eAAAgH,EAAA7G,EAAA,CAAqCsF,cAAA,EAAAxF,YAAA,EAAAC,IAAAY,KAAsCP,EAAAO,EAAA,SAAAkG,GAAiB,IAAA7G,EAAA6G,KAAAvG,WAAA,WAAiC,OAAAuG,EAAAmC,SAAiB,WAAY,OAAAnC,GAAU,OAAAzG,EAAAZ,EAAAQ,EAAA,IAAAA,MAAsBI,EAAAT,EAAA,SAAAkH,EAAAzG,GAAmB,OAAAR,OAAAkB,UAAAC,eAAA1B,KAAAwH,EAAAzG,IAAiDA,EAAAY,EAAA,GAAAZ,IAAAa,EAAA,GAAvc,CAAwd,CAAEgI,EAAA,SAAApC,EAAAzG,EAAAJ,GAAkB,aAA8yBJ,OAAAC,eAAAO,EAAA,cAAsCD,OAAA,IAASC,EAAAoF,WAAh1B,SAAA7E,EAAAkG,GAAc,OAAAjH,OAAA4D,oBAAAqD,GAAApB,QAAA,SAAArF,GAAyD,IAAAJ,EAAA6G,EAAAzG,GAAW,iBAAAJ,GAAA,OAAAA,GAAAW,EAAAX,KAAmCJ,OAAAsJ,OAAArC,IAA2tBzG,EAAA+I,QAAxsB,SAAAtC,GAAgR,IAAA7G,EAAA,GAAS,OAA3Q,SAAAI,EAAAyG,EAAAlG,GAAgB,GAAAf,OAAAiH,OAAA7G,EAAAW,GAAAkG,OAAwB,GAAAE,MAAAC,QAAAH,GAAA,OAAAA,EAAAM,OAAAnH,EAAAW,GAAA,QAAiD,QAAAhB,EAAA,EAAiBA,EAAAkH,EAAAM,OAAWxH,IAAAS,EAAAyG,EAAAlH,GAAAgB,IAAA,IAAAhB,EAAA,GAAAA,OAA2B,CAAK,IAAAyJ,EAAAxJ,OAAA4D,oBAAAqD,GAAoC,IAAAuC,EAAAjC,OAAAiC,EAAA3D,QAAA,SAAAzF,GAAmC,OAAAI,EAAAyG,EAAA7G,GAAAW,IAAA,IAAAX,OAA2BA,EAAAW,GAAA,IAAoBP,CAAAyG,EAAA,IAAA7G,GAA+aI,EAAAiJ,UAA9Z,SAAAxC,GAAc,GAAAjH,OAAAiH,QAAAE,MAAAC,QAAAH,GAAA,OAAAA,EAA4C,IAAAzG,EAAAJ,EAAAW,EAAAhB,EAAAyJ,EAAA,GAAiB,OAAAxJ,OAAA4D,oBAAAqD,GAAApB,QAAA,SAAA6D,GAAyDlJ,EAAAgJ,EAAApJ,EAAA,GAAAW,EAAA2I,EAAAC,MAAA,KAAwB,QAAArK,EAAA,EAAYA,EAAAyB,EAAAwG,OAAWjI,IAAAS,GAAA6J,MAAAC,SAAA9I,EAAAzB,GAAA,KAAAkB,IAAAJ,KAAAI,EAAAJ,GAAAL,EAAA,OAAqDK,EAAAW,EAAAzB,GAASkB,EAAAJ,GAAA6G,EAAAyC,KAAUF,EAAA,KAAmKhJ,EAAAsJ,eAA3J,SAAA7C,GAAc,aAAAA,EAAA,oBAAAA,EAAA,GAAAA,EAAA,iBAAAA,EAAA8C,KAAAC,UAAA/C,0BCA3uC,oBAAAkC,WAA3JpK,EAAAD,QAA0M,SAAAmI,GAAmB,SAAAzG,EAAAJ,GAAc,GAAAW,EAAAX,GAAA,OAAAW,EAAAX,GAAAtB,QAA4B,IAAAiB,EAAAgB,EAAAX,GAAA,CAAYd,EAAAc,EAAAb,GAAA,EAAAT,QAAA,IAAqB,OAAAmI,EAAA7G,GAAAX,KAAAM,EAAAjB,QAAAiB,IAAAjB,QAAA0B,GAAAT,EAAAR,GAAA,EAAAQ,EAAAjB,QAA2D,IAAAiC,EAAA,GAAS,OAAAP,EAAAd,EAAAuH,EAAAzG,EAAAb,EAAAoB,EAAAP,EAAAZ,EAAA,SAAAqH,EAAAlG,EAAAX,GAAuCI,EAAAT,EAAAkH,EAAAlG,IAAAf,OAAAC,eAAAgH,EAAAlG,EAAA,CAAqC2E,cAAA,EAAAxF,YAAA,EAAAC,IAAAC,KAAsCI,EAAAO,EAAA,SAAAkG,GAAiB,IAAAlG,EAAAkG,KAAAvG,WAAA,WAAiC,OAAAuG,EAAAmC,SAAiB,WAAY,OAAAnC,GAAU,OAAAzG,EAAAZ,EAAAmB,EAAA,IAAAA,MAAsBP,EAAAT,EAAA,SAAAkH,EAAAzG,GAAmB,OAAAR,OAAAkB,UAAAC,eAAA1B,KAAAwH,EAAAzG,IAAiDA,EAAAY,EAAA,GAAAZ,IAAAa,EAAA,GAAvc,CAAwd,WAAA4F,EAAAzG,EAAAO,GAAmB,aAAaf,OAAAC,eAAAO,EAAA,cAAsCD,OAAA,IAASC,EAAAyJ,aAAA,SAAAhD,EAAAzG,QAA+B,IAAAyG,MAAA,aAAAzG,MAAA,kEAAoG,QAAAO,EAAA,GAAaA,EAAAwG,OAAAN,GAAWlG,GAAAP,EAAAiE,OAAAyF,KAAAC,MAAAD,KAAAE,SAAA5J,EAAA+G,SAAiD,OAAAxG,GAASP,EAAA6J,aAAA,WAA2B,OAAA7J,EAAAyJ,aAAA,OAAAzJ,EAAAyJ,aAAA,OAAAzJ,EAAAyJ,aAAA,OAAAzJ,EAAAyJ,aAAA,IAA2FzJ,EAAAqC,wBAAA,SAAAoE,GAAuC,IAAAlG,EAAA,EAAAX,EAAAI,EAAA6J,eAAAtK,EAAAkH,EAAA,IAAA7G,EAAqC,kBAAkB,OAAAL,EAAA,OAAAgB","file":"state-store.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"store\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"store\"] = factory();\n\telse\n\t\troot[\"store\"] = factory();\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n","import {deepFreeze} from '@sardonyxwt/utils/object';\nimport {createUniqueIdGenerator} from '@sardonyxwt/utils/generator';\n\n/**\n * @type ScopeConfig\n * @summary Scope configuration\n * @param {string} name The name of scope.\n * @default Generate unique name.\n * @param {any} initState The initial scope state.\n * @default Empty object.\n * @param {ScopeMiddleware[]} middleware The scope middleware.\n * @description You can use middleware to use aspect programing.\n * @default Empty array.\n * @param {boolean} isSubscribeMacroAutoCreateEnable Is create subscribe macro when register action.\n * @default false.\n * @param {boolean} isFrozen Is scope frozen.\n * @default false.\n */\nexport type ScopeConfig<T> = {\n  name?: string,\n  initState?: T,\n  middleware?: ScopeMiddleware<T>[],\n  isSubscribeMacroAutoCreateEnable?: boolean,\n  isFrozen?: boolean\n};\n/**\n * @type StoreConfig\n * @summary Store configuration\n * @param {string} name The name of scope.\n * @param {boolean} isFrozen Is store frozen.\n * @default false.\n */\nexport type StoreConfig = {\n  name: string,\n  isFrozen?: boolean\n};\nexport type ScopeEvent<T = any> = {\n  newState: T,\n  oldState: T,\n  scopeName: string,\n  storeName: string,\n  actionName: string,\n  props,\n  parentEvent?: ScopeEvent<T>,\n  childrenEvents?: ScopeEvent<T>[]\n};\nexport type ScopeError<T = any> = {\n  reason,\n  oldState: T,\n  scopeName: string,\n  actionName: string,\n  props\n};\nexport type ScopeListenerUnsubscribeCallback = (() => boolean) & {listenerId: string};\nexport type ScopeListener<T> = (event: ScopeEvent<T>) => void;\nexport type ScopeAction<T, PROPS> = (state: T, props?: PROPS) => T;\nexport type ScopeMacro<T, PROPS, OUT> = (state: T, props?: PROPS) => OUT;\nexport type ScopeActionResultTransformer<T, PROPS, TRANSFORMED_OUT> = (actionResult: T, props: PROPS) => TRANSFORMED_OUT;\nexport type ScopeActionDispatcher<T, PROPS, OUT> = (props?: PROPS, emitEvent?: boolean) => OUT;\n\nexport enum ScopeMacroType {\n  GETTER = 'GETTER',\n  SETTER = 'SETTER',\n  FUNCTION = 'FUNCTION',\n}\n\n/**\n * @interface Scope\n * @summary The whole state of your app is stored in an scopes.\n */\nexport interface Scope<T = any> {\n\n  /**\n   * @var name.\n   * @summary Scope name.\n   * @description Name unique for scope.\n   */\n  readonly name: string;\n\n  /**\n   * @var state\n   * @summary Scope state.\n   */\n  readonly state: T;\n\n  /**\n   * @var context\n   * @summary Scope action current context.\n   */\n  readonly context: T;\n\n  /**\n   * @var store\n   * @summary Scope parent store.\n   */\n  readonly store: Store;\n\n  /**\n   * @var isLocked\n   * @summary Is locked status.\n   */\n  readonly isLocked: boolean;\n\n  /**\n   * @var isActionDispatchAvailable\n   * @summary Is action dispatch available status.\n   */\n  readonly isActionDispatchAvailable: boolean;\n\n  /**\n   * @var isSubscribeMacroAutoCreateEnable\n   * @summary Is subscribe macro auto create enable.\n   */\n  readonly isSubscribeMacroAutoCreateEnable: boolean;\n\n  /**\n   * @var supportActions\n   * @summary Support actions.\n   */\n  readonly supportActions: string[];\n\n  /**\n   * @function registerAction\n   * @summary Registers a new action in scope.\n   * @param {string} actionName The action name.\n   * @param {ScopeAction} action The action that changes the state of scope.\n   * @param {ScopeActionResultTransformer} transformer The transformer change returned result.\n   * @return {ScopeActionDispatcher} Return action dispatcher.\n   * You can use it to dispatch action without call scope.dispatch.\n   * @throws {Error} Will throw an error if the scope locked or action name exists in scope\n   * when it is called.\n   */\n  registerAction<PROPS, TRANSFORMED_OUT = T>(\n    actionName: string,\n    action: ScopeAction<T, PROPS>,\n    transformer?: ScopeActionResultTransformer<T, PROPS, TRANSFORMED_OUT>\n  ): ScopeActionDispatcher<T, PROPS, TRANSFORMED_OUT>;\n\n  /**\n   * @function registerMacro\n   * @summary Registers a new macro in scope.\n   * @param {string} macroName The transformer name.\n   * @param {ScopeMacro} macro The transformer used to add getter macros to scope.\n   * @param {ScopeMacroType} macroType Register macro type.\n   * @throws {Error} Will throw an error if the scope locked or macro name exists in scope\n   * when it is called.\n   */\n  registerMacro<PROPS, OUT>(\n    macroName: string,\n    macro: ScopeMacro<T, PROPS, OUT>,\n    macroType?: ScopeMacroType\n  );\n\n  /**\n   * @function dispatch\n   * @summary Dispatches an action.\n   * @description Dispatches an action is the only way to trigger a scope change.\n   * @param {string} actionName Triggered action with same name.\n   * @description This action change state of scope and return new state.\n   * You can use resolve to change the state or reject to throw an exception.\n   * @param {any?} props Additional data for the correct operation of the action.\n   * @param {boolean?} emitEvent You can specify emit event or not.\n   * @return {any extends T} Return new state.\n   * @throws {Error} Will throw an error if the actionName not present in scope\n   * or {isActionDispatchAvailable} is false.\n   */\n  dispatch(actionName: string, props?, emitEvent?: boolean): T;\n\n  /**\n   * @function subscribe\n   * @summary Adds a scope change listener.\n   * @description It will be called any time an action is dispatched.\n   * @param {ScopeListener} listener A callback to be invoked on every dispatch.\n   * @param {string | string[]} actionName Specific action to subscribe.\n   * @return {ScopeListenerUnsubscribeCallback} A listener unsubscribe callback to remove this change listener later.\n   * @throws {Error} Will throw an error if actionName not present in scope.\n   */\n  subscribe(listener: ScopeListener<T>, actionName?: string | string[]): ScopeListenerUnsubscribeCallback;\n\n  /**\n   * @function unsubscribe\n   * @summary Removes a scope change listener.\n   * @param {string} id Id of the listener to delete.\n   * @return {boolean} Status of unsubscribe action.\n   */\n  unsubscribe(id: string): boolean;\n\n  /**\n   * @function lock\n   * @summary Prevents the addition of new actions to scope.\n   */\n  lock(): void;\n\n  /**\n   * @function reset\n   * @summary Reset scope state.\n   */\n  reset(): void;\n\n}\n\n/**\n * @interface ScopeMiddleware\n * @summary You can use middleware to use aspect programing.\n */\nexport interface ScopeMiddleware<T> {\n\n  /**\n   * @function postSetup\n   * @param {Scope} scope Created scope.\n   * @summary You can use this method to setup custom actions in scope or\n   * subscribe to actions in scope. Lock scope in this point is bad practice.\n   */\n  postSetup(scope: Scope<T>): void;\n\n  /**\n   * @function appendActionMiddleware\n   * @summary This method wraps the action with a new action and returns it.\n   * @param {ScopeAction} action Wrapped action.\n   * @return {ScopeAction} Action that wrapped old action\n   */\n  appendActionMiddleware<PROPS>(action: ScopeAction<T, PROPS>): ScopeAction<T, PROPS>;\n\n}\n\nexport enum ScopeChangeEventType {\n  REGISTER_MACRO = 'REGISTER_MACRO',\n  REGISTER_ACTION = 'REGISTER_ACTION',\n  LOCK = 'LOCK'\n}\n\nexport enum StoreChangeEventType {\n  CREATE_SCOPE = 'CREATE_SCOPE',\n  LOCK = 'LOCK'\n}\n\nexport interface ScopeChangeDetails {\n  type: ScopeChangeEventType;\n  actionName?: string;\n  macroName?: string;\n  macroType?: ScopeMacroType;\n}\n\nexport interface StoreChangeDetails {\n  type: StoreChangeEventType;\n  scopeName?: string;\n}\n\n/**\n * @interface StoreDevTool\n * @summary You can use StoreDevTool to handle all action in store.\n */\nexport interface StoreDevTool {\n\n  /**\n   * @function onCreateStore\n   * @summary Call when created new store.\n   * @param {Store} store Created store.\n   */\n  onCreateStore(store: Store): void;\n\n  /**\n   * @function onChangeStore\n   * @summary Call when change store (lock, createScope).\n   * @param {Scope} store Changed store.\n   * @param {ScopeChangeDetails} details Additional store change details.\n   */\n  onChangeStore(store: Store, details: StoreChangeDetails): void;\n\n  /**\n   * @function onCreateScope\n   * @summary Call when created new scope.\n   * @param {Scope} scope Created scope.\n   */\n  onCreateScope(scope: Scope): void;\n\n  /**\n   * @function onChangeScope\n   * @summary Call when change scope (lock, registerAction, dispatch).\n   * @param {Scope} scope Changed scope.\n   * @param {ScopeChangeDetails} details Additional scope change details.\n   */\n  onChangeScope(scope: Scope, details: ScopeChangeDetails): void;\n\n  /**\n   * @function onAction\n   * @summary Call when in any scope dispatch action.\n   * @param {ScopeEvent} event Action event.\n   */\n  onAction(event: ScopeEvent): void;\n\n  /**\n   * @function onActionError\n   * @summary Call when in any scope dispatch action error.\n   * @param {ScopeError} error Action error.\n   */\n  onActionError(error: ScopeError): void;\n\n  /**\n   * @function onActionListenerError\n   * @summary Call when in any scope listener dispatch error.\n   * @param {ScopeError} error ActionListener error.\n   */\n  onActionListenerError(error: ScopeError): void;\n\n}\n\n/**\n * @interface Store\n * @summary The whole state of your app is stored in an scopes inside a store.\n */\nexport interface Store {\n\n  /**\n   * @var name.\n   * @summary Store name.\n   * @description Name unique for store.\n   */\n  readonly name: string;\n\n  /**\n   * @var isLocked\n   * @summary Is locked status.\n   */\n  readonly isLocked: boolean;\n\n  /**\n   * @var state\n   * @summary Store state.\n   */\n  readonly state: { [scopeName: string]: any };\n\n  /**\n   * @var scopes\n   * @summary Store scopes.\n   */\n  readonly scopes: string[];\n\n  /**\n   * @function createScope\n   * @summary Create a new scope and return it.\n   * @param {ScopeConfig} config The config of scope.\n   * @return {Scope} Scope.\n   * @throws {Error} Will throw an error if name of scope not unique.\n   */\n  createScope<T = any>(config?: ScopeConfig<T>): Scope<T>;\n\n  /**\n   * @function getScope\n   * @summary Returns scope.\n   * @param {string} scopeName Name scope, to get the Scope.\n   * @return {Scope} Scope\n   * @throws {Error} Will throw an error if scope not present.\n   */\n  getScope<T = any>(scopeName: string): Scope<T>;\n\n  /**\n   * @function lock\n   * @summary Prevents the creation of new scope to store and lock all included scopes.\n   */\n  lock(): void;\n\n  /**\n   * @function reset\n   * @summary Reset scopes state.\n   */\n  reset(): void;\n\n}\n\nconst stores: Store[] = [];\nconst storeDevTool: StoreDevTool = {\n  onCreateStore: () => null,\n  onChangeStore: () => null,\n  onCreateScope: () => null,\n  onChangeScope: () => null,\n  onAction: () => null,\n  onActionError: () => null,\n  onActionListenerError: () => null\n};\n\nclass ScopeImpl<T> implements Scope<T> {\n\n  private readonly _name: string;\n  private readonly _initState: T;\n  private _state: T;\n  private _context: T;\n  private _store: Store;\n  private _isFrozen: boolean;\n  private _isActionInProgress: boolean = false;\n  private _isActionDispatchAvailable: boolean = true;\n  private readonly _isSubscribeMacroAutoCreateEnable: boolean;\n  private _middleware: ScopeMiddleware<T>[];\n  private _actions: { [key: string]: ScopeAction<T, any> } = {};\n  private _listeners: { [key: string]: ScopeListener<T> } = {};\n  private _contextEvents: ScopeEvent<T>[];\n  private readonly _listenerIdGenerator = createUniqueIdGenerator('ScopeListener');\n\n  constructor(store: Store, config: ScopeConfig<T>) {\n    const {name, initState, middleware, isSubscribeMacroAutoCreateEnable, isFrozen} = config;\n    this._name = name;\n    this._initState =  initState;\n    this._state = initState;\n    this._store = store;\n    // This code needed to save middleware correct order in dispatch method.\n    this._middleware = [...middleware].reverse();\n    this._isSubscribeMacroAutoCreateEnable = isSubscribeMacroAutoCreateEnable;\n    this._isFrozen = isFrozen;\n  }\n\n  get name() {\n    return this._name;\n  }\n\n  get isLocked() {\n    return this._isFrozen;\n  }\n\n  get isActionDispatchAvailable() {\n    return this._isActionDispatchAvailable;\n  }\n\n  get isSubscribeMacroAutoCreateEnable() {\n    return this._isSubscribeMacroAutoCreateEnable;\n  }\n\n  get state() {\n    return this._state;\n  }\n\n  get context() {\n    return this._context;\n  }\n\n  get store() {\n    return this._store;\n  }\n\n  get supportActions() {\n    return Object.getOwnPropertyNames(this._actions);\n  }\n\n  registerAction<PROPS, TRANSFORMED_OUT = T>(\n    actionName: string,\n    action: ScopeAction<T, PROPS>,\n    transformer: ScopeActionResultTransformer<T, PROPS, TRANSFORMED_OUT>\n      = actionResult => <TRANSFORMED_OUT>(actionResult as any)\n  ) {\n    if (!transformer) {\n      throw new Error(`Transformer cannot be null or undefined.`);\n    }\n    if (this._isFrozen) {\n      throw new Error(`This scope is locked you can't add new action.`);\n    }\n    if (actionName in this._actions || (this._isSubscribeMacroAutoCreateEnable && actionName in this)) {\n      throw new Error(`Action name ${actionName} is duplicate or reserved in scope ${this._name}.`);\n    }\n    this._actions[actionName] = action;\n\n    const actionDispatcher = (props?: PROPS, emitEvent?: boolean) => {\n      return transformer(this.dispatch(actionName, props, emitEvent), props);\n    };\n\n    if (this._isSubscribeMacroAutoCreateEnable) {\n      const capitalizeFirstLetterActionName = () => {\n        return actionName.charAt(0).toUpperCase() + actionName.slice(1);\n      };\n\n      const subscriberMacroName = `on${capitalizeFirstLetterActionName()}`;\n\n      this.registerMacro(subscriberMacroName, (state, listener: ScopeListener<T>) => {\n        return this.subscribe(listener, actionName);\n      });\n    }\n\n    this[actionName] = actionDispatcher;\n\n    storeDevTool.onChangeScope(this, {type: ScopeChangeEventType.REGISTER_ACTION, actionName});\n\n    return actionDispatcher;\n  }\n\n  registerMacro<IN, OUT>(\n    macroName: string,\n    macro: ScopeMacro<T, IN, OUT>,\n    macroType: ScopeMacroType = ScopeMacroType.FUNCTION\n  ) {\n    if (!macro) {\n      throw new Error(`Macro cannot be null or undefined.`);\n    }\n    if (this._isFrozen) {\n      throw new Error(`This scope is locked you can't add new macro.`);\n    }\n    const isMacroExist = macroName in this;\n    const isPresentMacroHasFunctionType = () => typeof this[macroName] === 'function';\n\n    if (isMacroExist\n      && (isPresentMacroHasFunctionType()\n        || macroType === ScopeMacroType.FUNCTION\n        || (macroType === ScopeMacroType.GETTER && Object.getOwnPropertyDescriptor(this, macroName).get)\n        || (macroType === ScopeMacroType.SETTER && Object.getOwnPropertyDescriptor(this, macroName).set))) {\n      throw new Error(`Macro name ${macroName} is reserved in scope ${this._name}.`);\n    }\n    const macroFunc = (props?: IN) => {\n      return macro(this._state, props);\n    };\n    switch (macroType) {\n      case ScopeMacroType.FUNCTION:\n        this[macroName] = macroFunc;\n        break;\n      case ScopeMacroType.GETTER:\n        Object.defineProperty(this, macroName, {get: macroFunc, configurable: true, enumerable: true});\n        break;\n      case ScopeMacroType.SETTER:\n        Object.defineProperty(this, macroName, {set: macroFunc, configurable: true, enumerable: true});\n        break;\n    }\n\n    storeDevTool.onChangeScope(this, {type: ScopeChangeEventType.REGISTER_MACRO, macroName, macroType});\n  }\n\n  dispatch(actionName: string, props?, emitEvent = true) {\n    let action: ScopeAction<T, any> = this._actions[actionName];\n\n    if (!action) {\n      throw new Error(`This action not exists ${actionName}`);\n    }\n\n    if (!this._isActionDispatchAvailable) {\n      throw new Error('Now action dispatch not available. Other action spreads.');\n    }\n\n    if (props && typeof props === 'object') {\n      deepFreeze(props);\n    }\n\n    this._middleware.forEach(\n      middleware => action = middleware.appendActionMiddleware(action)\n    );\n\n    const oldState = this._isActionInProgress ? this._context : this._state;\n\n    const buildScopeError = (reason) => ({\n      reason,\n      oldState,\n      scopeName: this._name,\n      actionName,\n      props\n    }) as ScopeError<T>;\n\n    const onFulfilled = newState => {\n      deepFreeze(newState);\n      const event: ScopeEvent<T> = {\n        oldState,\n        newState,\n        scopeName: this._name,\n        storeName: this._store.name,\n        actionName,\n        props\n      };\n\n      if (this._isActionInProgress) {\n        if (emitEvent) {\n          this._contextEvents\n            ? this._contextEvents.push(event)\n            : this._contextEvents = [event];\n        }\n        this._context = newState;\n        return newState;\n      }\n\n      this._context = null;\n      this._state = newState;\n\n      if (this._contextEvents) {\n        event.childrenEvents = this._contextEvents\n          .map(contextEvent => ({...contextEvent, parentEvent: event}));\n      }\n\n      this._contextEvents = null;\n      this._isActionDispatchAvailable = false;\n\n      const dispatchEvent = (event: ScopeEvent<T>) => {\n        storeDevTool.onAction(event);\n        Object.getOwnPropertyNames(this._listeners).forEach(key => {\n          const listener = this._listeners[key];\n          try {\n            if (listener) listener(event);\n          } catch (reason) {\n            storeDevTool.onActionListenerError(buildScopeError(reason));\n          }\n        });\n      };\n\n      if (emitEvent) {\n        if (event.childrenEvents) {\n          event.childrenEvents.forEach(dispatchEvent);\n        }\n        dispatchEvent(event);\n      }\n\n      this._isActionDispatchAvailable = true;\n\n      return newState;\n    };\n\n    const onRejected = reason => {\n      const error = buildScopeError(reason);\n      if (!this._isActionInProgress) {\n        storeDevTool.onActionError(error);\n      }\n      return error;\n    };\n\n    if (this._isActionInProgress) {\n      try {\n        return onFulfilled(action(oldState, props));\n      } catch (e) {\n        throw onRejected(e);\n      }\n    }\n\n    try {\n      this._isActionInProgress = true;\n      this._context = oldState;\n      const actionResult = action(oldState, props);\n      this._isActionInProgress = false;\n      return onFulfilled(actionResult);\n    } catch (e) {\n      this._isActionInProgress = false;\n      throw onRejected(e);\n    }\n  }\n\n  subscribe(listener: ScopeListener<T>, actionName?: string | string[]): ScopeListenerUnsubscribeCallback {\n    const actionNames: string[] = [];\n\n    if (Array.isArray(actionName)) {\n      actionNames.push(...actionName);\n    } else if (actionName) {\n      actionNames.push(actionName);\n    }\n\n    actionNames.forEach(actionName => {\n      if (!(actionName in this._actions)) {\n        throw new Error(`Action (${actionName}) not present in scope.`);\n      }\n    });\n\n    const listenerId = this._listenerIdGenerator();\n    this._listeners[listenerId] = event => {\n\n      if (actionNames.length === 0) {\n        return listener(event);\n      }\n\n      const isActionPresentInScope = actionNames.findIndex(\n        actionName => actionName === event.actionName\n      ) !== -1;\n\n      if (isActionPresentInScope) {\n        listener(event);\n      }\n    };\n\n    return Object.assign(() => this.unsubscribe(listenerId), {listenerId});\n  }\n\n  unsubscribe(id: string) {\n    return delete this._listeners[id];\n  }\n\n  lock() {\n    this._isFrozen = true;\n    storeDevTool.onChangeScope(this, {type: ScopeChangeEventType.LOCK});\n  }\n\n  reset() {\n    this._state = this._initState;\n  }\n\n}\n\nclass StoreImpl implements Store {\n\n  private readonly _name: string;\n  private readonly _scopes: Scope[];\n  private readonly _scopeNameGenerator = createUniqueIdGenerator('Scope');\n  private _isFrozen: boolean;\n\n  constructor(config: StoreConfig) {\n    const {name, isFrozen} = config;\n    this._name = name;\n    this._isFrozen = isFrozen;\n    this._scopes = [];\n  }\n\n  get name() {\n    return this._name;\n  }\n\n  get isLocked() {\n    return this._isFrozen;\n  }\n\n  get state() {\n    const state = {};\n    this._scopes.forEach(scope => {\n      state[scope.name] = scope.state;\n    });\n    return state;\n  }\n\n  get scopes() {\n    return this._scopes.map(it => it.name);\n  }\n\n  createScope<T>(config: ScopeConfig<T> = {}): Scope<T> {\n    if (this._isFrozen) {\n      throw new Error(`This Store is locked you can't add new scope.`);\n    }\n    const {\n      name = this._scopeNameGenerator(),\n      initState = null,\n      middleware = [],\n      isSubscribeMacroAutoCreateEnable = false,\n      isFrozen = false\n    } = config;\n    const isScopeExist = !!this._scopes.find(it => it.name === name);\n    if (isScopeExist) {\n      throw new Error(`Scope name must unique`);\n    }\n    let scope = new ScopeImpl<T>(this, {\n      name,\n      initState,\n      middleware: middleware as ScopeMiddleware<T>[],\n      isSubscribeMacroAutoCreateEnable,\n      isFrozen\n    });\n    this._scopes.push(scope);\n    middleware.forEach(middleware => middleware.postSetup(scope));\n    storeDevTool.onCreateScope(scope);\n    storeDevTool.onChangeStore(this, {type: StoreChangeEventType.CREATE_SCOPE, scopeName: name});\n    return scope;\n  }\n\n  getScope<T = {}>(scopeName: string): Scope<T> {\n    const scope = this._scopes.find(it => it.name === scopeName);\n    if (!scope) {\n      throw new Error(`Scope with name ${scopeName} not present in store with name ${this._name}`);\n    }\n    return scope;\n  }\n\n  lock() {\n    this._isFrozen = true;\n    this._scopes.forEach(it => it.lock());\n    storeDevTool.onChangeStore(this, {type: StoreChangeEventType.LOCK});\n  }\n\n  reset() {\n    this._scopes.forEach(it => it.reset());\n  }\n\n}\n\n/**\n * @function createStore\n * @summary Create a new store and return it.\n * @param {StoreConfig} config Name of store.\n * @return {Store} Store.\n * @throws {Error} Will throw an error if name of store not unique.\n */\nexport function createStore(config: StoreConfig): Store {\n  const {\n    name,\n    isFrozen = false,\n  } = config;\n  const isStoreExist = !!stores.find(it => it.name === name);\n  if (isStoreExist) {\n    throw new Error('Store name must unique');\n  }\n  const store = new StoreImpl({name, isFrozen});\n  stores.push(store);\n  storeDevTool.onCreateStore(store);\n  return store;\n}\n\n/**\n * @function getStore\n * @summary Returns store.\n * @param {string} storeName Name scope, to get the Scope.\n * @return {Store} Store\n * @throws {Error} Will throw an error if scope not present.\n */\nexport function getStore(storeName: string): Store {\n  const store = stores.find(it => it.name === storeName);\n  if (!store) {\n    throw new Error(`Store with name ${storeName} not present`);\n  }\n  return store;\n}\n\n/**\n * @function getState\n * @summary Returns all store states.\n * @return {{string: {string: any}}} Scope states\n */\nexport function getState() {\n  const state = {};\n  stores.forEach(store => {\n    state[store.name] = store.state;\n  });\n  return state;\n}\n\n/**\n * @function setStoreDevTool\n * @summary Set store dev tool.\n * @param {StoreDevTool} devTool Dev tool middleware, to handle store changes.\n */\nexport function setStoreDevTool(devTool: Partial<StoreDevTool>) {\n  Object.assign(storeDevTool, devTool);\n}\n","!function(e,t){if(\"object\"==typeof exports&&\"object\"==typeof module)module.exports=t();else if(\"function\"==typeof define&&define.amd)define([],t);else{var r=t();for(var n in r)(\"object\"==typeof exports?exports:e)[n]=r[n]}}(\"undefined\"!=typeof self?self:this,function(){return function(e){function t(n){if(r[n])return r[n].exports;var o=r[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var r={};return t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,\"a\",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p=\"\",t(t.s=2)}({2:function(e,t,r){\"use strict\";function n(e){return Object.getOwnPropertyNames(e).forEach(function(t){var r=e[t];\"object\"==typeof r&&null!==r&&n(r)}),Object.freeze(e)}function o(e){function t(e,n){if(Object(e)!==e)r[n]=e;else if(Array.isArray(e))if(0===e.length)r[n]=[];else for(var o=0;o<e.length;o++)t(e[o],n?n+\".\"+o:\"\"+o);else{var f=Object.getOwnPropertyNames(e);0!==f.length?f.forEach(function(r){return t(e[r],n?n+\".\"+r:r)}):r[n]={}}}var r={};return t(e,\"\"),r}function f(e){if(Object(e)!==e||Array.isArray(e))return e;var t,r,n,o,f={};return Object.getOwnPropertyNames(e).forEach(function(u){t=f,r=\"\",n=u.split(\".\");for(var i=0;i<n.length;i++)o=!isNaN(parseInt(n[i],10)),t=t[r]||(t[r]=o?[]:{}),r=n[i];t[r]=e[u]}),f[\"\"]}function u(e){return void 0===e||null===e?\"\":\"number\"==typeof e?\"\"+e:\"object\"==typeof e?JSON.stringify(e):e}Object.defineProperty(t,\"__esModule\",{value:!0}),t.deepFreeze=n,t.flatten=o,t.unflatten=f,t.stringifyValue=u}})});\n//# sourceMappingURL=object.min.js.map","!function(e,t){if(\"object\"==typeof exports&&\"object\"==typeof module)module.exports=t();else if(\"function\"==typeof define&&define.amd)define([],t);else{var n=t();for(var r in n)(\"object\"==typeof exports?exports:e)[r]=n[r]}}(\"undefined\"!=typeof self?self:this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,\"a\",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p=\"\",t(t.s=1)}([,function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.generateSalt=function(e,t){void 0===e&&(e=16),void 0===t&&(t=\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\");for(var n=\"\";n.length<e;)n+=t.charAt(Math.floor(Math.random()*t.length));return n},t.generateUUID=function(){return t.generateSalt(4)+\"-\"+t.generateSalt(4)+\"-\"+t.generateSalt(4)+\"-\"+t.generateSalt(4)},t.createUniqueIdGenerator=function(e){var n=0,r=t.generateUUID(),o=e+\":\"+r;return function(){return o+\":\"+ ++n}}}])});\n//# sourceMappingURL=generator.min.js.map"],"sourceRoot":""}