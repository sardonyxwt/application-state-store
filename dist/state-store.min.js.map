{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap 41b9e10c8f8f44c9c375","webpack:///./src/index.ts","webpack:///./node_modules/@sardonyxwt/utils/object/object.min.js","webpack:///./node_modules/@sardonyxwt/utils/generator/generator.min.js","webpack:///./node_modules/@sardonyxwt/utils/synchronized/synchronized.min.js"],"names":[],"mappings":"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","file":"./dist/state-store.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"store\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"store\"] = factory();\n\telse\n\t\troot[\"store\"] = factory();\n})(typeof self !== 'undefined' ? self : this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 41b9e10c8f8f44c9c375","import { deepFreeze } from '@sardonyxwt/utils/object';\nimport { uniqueId } from '@sardonyxwt/utils/generator';\nimport { syncPromises } from '@sardonyxwt/utils/synchronized';\n\nexport type Listener<T> = (event: { newState: T, oldState: T, actionName: string, props }) => void;\nexport type Action<T> = (state: T, props, resolve: (newState: T) => void, reject: (error) => void) => void;\n\nexport interface Scope<T = any> {\n\n  /**\n   * @var Scope name.\n   * Name unique for scope.\n   */\n  readonly name: string;\n\n  /**\n   * Registers a new action in scope.\n   * @param {string} name The action name.\n   * @param {Action} action The action that changes the state of scope\n   * @throws {Error} Will throw an error if the scope locked or action name exists in scope\n   * when it is called.\n   */\n  registerAction(name: string, action: Action<T>): void;\n\n  /**\n   * Dispatches an action. It is the only way to trigger a scope change.\n   * @param {string} actionName Triggered action with same name.\n   * This action change state of scope and return new state.\n   * You can use resolve to change the state or reject to throw an exception.\n   * @param {any?} props Additional data for the correct operation of the action.\n   * @return {Promise<>} You can use the promise to get a new state of scope\n   * or catch errors.\n   * @throws {Error} Will throw an error if the actionName not present in scope.\n   */\n  dispatch(actionName: string, props?): Promise<T>;\n\n  /**\n   * Adds a scope change listener.\n   * It will be called any time an action is dispatched.\n   * @param {Listener} listener A callback to be invoked on every dispatch.\n   * @param {string} actionName Specific action to subscribe.\n   * @return {string} A listener id to remove this change listener later.\n   * @throws {Error} Will throw an error if actionName not present in scope.\n   */\n  subscribe(listener: Listener<T>, actionName?: string): string;\n\n  /**\n   * Removes a scope change listener.\n   * @param {string} id Id of the listener to delete.\n   */\n  unsubscribe(id: string): boolean;\n\n  /**\n   * Adds a scope synchronized listener.\n   * It will be called any time an action is dispatched.\n   * @param {object} object Object to synchronized.\n   * @param {string} key Object property key for synchronized.\n   * @param {string} actionName Specific action to synchronize.\n   * @return {string} A listener id to remove this change listener later.\n   * @throws {Error} Will throw an error if actionName not present in scope.\n   */\n  synchronize(object: object, key: string, actionName?: string): string;\n\n  /**\n   * Prevents the addition of new actions to scope.\n   */\n  lock(): void;\n\n  /**\n   * Check is locked status.\n   * @return Is locked status.\n   */\n  isLocked(): boolean;\n\n  /**\n   * Returns scope state.\n   * @return Scope state.\n   */\n  getState(): T;\n\n  /**\n   * Returns support actions.\n   * @return Support actions.\n   */\n  getSupportActions(): string[];\n\n}\n\nclass ScopeImpl<T = any> implements Scope<T> {\n\n  private isFrozen = false;\n  private actions: { [key: string]: Action<T> } = {};\n  private listeners: { [key: string]: Listener<T> } = {};\n\n  constructor(readonly name: string, private state: T) {\n  }\n\n  registerAction(name: string, action: Action<T>) {\n    if (this.isFrozen) {\n      throw new Error(`This scope is locked you can't add new action.`);\n    }\n    if (name in this.actions) {\n      throw new Error(`Action name is duplicate in scope ${this.name}`);\n    }\n    this.actions[name] = action;\n  }\n\n  dispatch(actionName: string, props?) {\n    const action: Action<T> = this.actions[actionName];\n    if (!action) {\n      throw new Error(`This action not exists ${actionName}`);\n    }\n    if(props && typeof props === 'object') {\n      deepFreeze(props);\n    }\n    const oldState = this.state;\n    return new Promise<T>((resolve, reject) => {\n      action(oldState, props, resolve, reject);\n    }).then(newState => {\n      deepFreeze(newState);\n      Object.getOwnPropertyNames(this.listeners).forEach(\n        key => this.listeners[key]({oldState, newState, actionName, props})\n      );\n      this.state = newState;\n      return newState;\n    });\n  }\n\n  subscribe(listener: Listener<T>, actionName?: string) {\n    if (actionName && !(actionName in this.actions)) {\n      throw new Error(`Action (${actionName}) not present in scope.`);\n    }\n    const listenerId = uniqueId('listener');\n    this.listeners[listenerId] = event => {\n      if (!actionName || actionName === event.actionName) {\n        listener(event);\n      }\n    };\n    return listenerId;\n  }\n\n  synchronize(object: object, key: string, actionName?: string) {\n    object[key] = this.getState();\n    return this.subscribe(({newState}) => {\n      object[key] = newState;\n    }, actionName);\n  }\n\n  unsubscribe(id: string) {\n    return delete this.listeners[id];\n  }\n\n  lock() {\n    this.isFrozen = true;\n  }\n\n  isLocked() {\n    return this.isFrozen;\n  }\n\n  getState() {\n    return this.state;\n  }\n\n  getSupportActions() {\n    return Object.getOwnPropertyNames(this.actions);\n  }\n\n}\n\nclass ComposeScopeImpl extends ScopeImpl<{}> {\n\n  constructor(readonly name: string, private scopes: Scope[]) {\n    super(name, {});\n\n    let actionNames: string[] = [];\n    scopes.forEach(scope => {\n      scope.lock();\n      actionNames = [...actionNames, ...scope.getSupportActions()];\n    });\n    actionNames = actionNames.filter(\n      (actionName, i, self) => self.indexOf(actionName) === i\n    );\n    actionNames.forEach(actionName => this.registerAction(\n      actionName, (state, props, resolve, reject) => {\n        let dispatchPromises = scopes.filter(\n          scope => scope.getSupportActions().findIndex(\n            it => it === actionName\n          ) >= 0\n        ).map(scope => scope.dispatch(actionName, props));\n        syncPromises(dispatchPromises).then(\n          () => resolve(this.getState())\n        ).catch(reject);\n      }\n    ));\n    this.lock();\n  }\n\n  getState(): {} {\n    let state = {};\n\n    this.scopes.forEach(\n      scope => state[scope.name] = scope.getState()\n    );\n\n    return state;\n  }\n\n}\n\nconst scopes: { [key: string]: Scope<any> } = {};\n\n/**\n * Create a new scope and return it.\n * @param {string} name The name of scope.\n * @default Generate unique name.\n * @param {any} initState The initial scope state.\n * By default use empty object.\n * @return {Scope} Scope.\n * @throws {Error} Will throw an error if name of scope not unique.\n */\nexport function createScope<T>(name = uniqueId('scope'), initState: T = null): Scope<T> {\n  if (name in scopes) {\n    throw new Error(`Scope name must unique`);\n  }\n  const scope = new ScopeImpl<T>(name, initState);\n  scopes[name] = scope;\n  return scope;\n}\n\n/**\n * Compose a new scope and return it.\n * @description All scopes is auto lock.\n * @param {string} name The name of scope\n * @param {(Scope | string)[]} scopes Scopes to compose.\n * Length must be greater than one\n * @return {Scope} Compose scope.\n * @throws {Error} Will throw an error if scopes length less fewer than two.\n * @throws {Error} Will throw an error if name of scope not unique.\n */\nexport function composeScope(name, scopes: (Scope | string)[]): Scope {\n  if (name in scopes) {\n    throw new Error(`Scope name must unique`);\n  }\n  let composeScopes = scopes.map(\n    scope => typeof scope === \"string\" ? getScope(scope) : scope\n  ).filter(\n    (scope, i, self) => scope && self.indexOf(scope) === i\n  );\n  const MIN_COMPOSE_SCOPE_COUNT = 2;\n  if (composeScopes.length < MIN_COMPOSE_SCOPE_COUNT) {\n    throw new Error(`Compose scopes length must be greater than one`);\n  }\n  const scope = new ComposeScopeImpl(name, composeScopes);\n  scopes[name] = scope;\n  return scope;\n}\n\n/**\n * Returns scope.\n * @param {string} scopeName Name scope, to get the Scope.\n * @return {Scope} Scope\n * @throws {Error} Will throw an error if scope not present.\n */\nexport function getScope(scopeName: string) {\n  if (!scopes[scopeName]) {\n    throw new Error(`Scope with name ${scopeName} not present`);\n  }\n  return scopes[scopeName];\n}\n\n/**\n * Returns all scope states.\n * @return {{string: any}} Scope states\n */\nexport function getState() {\n  const state = {};\n  Object.getOwnPropertyNames(scopes).forEach(key => {\n    state[key] = scopes[key].getState();\n  });\n  return state;\n}\n\n/**\n * This scope is global\n * @type {Scope}\n */\nexport const ROOT_SCOPE = createScope('rootScope', {});\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.ts","!function(e,t){if(\"object\"==typeof exports&&\"object\"==typeof module)module.exports=t();else if(\"function\"==typeof define&&define.amd)define([],t);else{var n=t();for(var r in n)(\"object\"==typeof exports?exports:e)[r]=n[r]}}(\"undefined\"!=typeof self?self:this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,\"a\",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p=\"\",t(t.s=3)}({3:function(e,t,n){\"use strict\";function r(e){return Object.getOwnPropertyNames(e).forEach(function(t){var n=e[t];\"object\"==typeof n&&null!==n&&r(n)}),Object.freeze(e)}Object.defineProperty(t,\"__esModule\",{value:!0}),t.deepFreeze=r}})});\n//# sourceMappingURL=object.min.js.map\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/@sardonyxwt/utils/object/object.min.js\n// module id = 1\n// module chunks = 0","!function(e,t){if(\"object\"==typeof exports&&\"object\"==typeof module)module.exports=t();else if(\"function\"==typeof define&&define.amd)define([],t);else{var n=t();for(var r in n)(\"object\"==typeof exports?exports:e)[r]=n[r]}}(\"undefined\"!=typeof self?self:this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,\"a\",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p=\"\",t(t.s=1)}([,function(e,t,n){\"use strict\";function r(e){for(var t=\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\",n=[];n.length<e;)n.push(t.charAt(Math.floor(Math.random()*t.length)));return n}function o(e,t){void 0===e&&(e=\"\"),void 0===t&&(t=!1),u[e]?++u[e]:u[e]=0;var n=e+u[e];return t&&(n=n+\"-\"+r(8).join(\"\")),n}Object.defineProperty(t,\"__esModule\",{value:!0});var u={};t.generateSeed=r,t.uniqueId=o}])});\n//# sourceMappingURL=generator.min.js.map\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/@sardonyxwt/utils/generator/generator.min.js\n// module id = 2\n// module chunks = 0","!function(e,t){if(\"object\"==typeof exports&&\"object\"==typeof module)module.exports=t();else if(\"function\"==typeof define&&define.amd)define([],t);else{var n=t();for(var r in n)(\"object\"==typeof exports?exports:e)[r]=n[r]}}(\"undefined\"!=typeof self?self:this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,\"a\",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p=\"\",t(t.s=4)}({4:function(e,t,n){\"use strict\";function r(e){return new i(e)}function o(e){return Promise.all(e.map(function(e){return Promise.resolve(e)}))}Object.defineProperty(t,\"__esModule\",{value:!0});var i=function(){function e(e){this.action=e,this.cache={}}return e.prototype.get=function(e){if(e in this.cache)return this.cache[e];var t=this.action(e);return this.cache[e]=t,t},e.prototype.has=function(e){return e in this.cache},e.prototype.remove=function(e){var t=this,n=this.has(e);return n&&this.get(e).then(function(){return delete t.cache[e]}),n},e}();t.createSyncCache=r,t.syncPromises=o}})});\n//# sourceMappingURL=synchronized.min.js.map\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/@sardonyxwt/utils/synchronized/synchronized.min.js\n// module id = 3\n// module chunks = 0"],"sourceRoot":""}