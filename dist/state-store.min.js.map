{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap 9be1c3ac539c94ad6ac0","webpack:///./src/index.ts","webpack:///./src/utils.ts"],"names":[],"mappings":"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","file":"./dist/state-store.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse {\n\t\tvar a = factory();\n\t\tfor(var i in a) (typeof exports === 'object' ? exports : root)[i] = a[i];\n\t}\n})(typeof self !== 'undefined' ? self : this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 9be1c3ac539c94ad6ac0","import {uniqueId, deepFreeze} from './utils';\n\nexport type Listener<T> = (event: { newScope: T, oldScope: T, actionName: string }) => void;\nexport type Action<T> = (scope: T, props, resolve: (newScope: T) => void, reject: (error) => void) => void;\n\nexport class Scope<T = any> {\n\n  private isFrozen = false;\n  private actions = new Map<string, Action<T>>();\n  private listeners = new Map<string, Listener<T>>();\n\n  constructor(readonly name: string, private state: T) {\n  }\n\n  /**\n   * Registers a new action in scope.\n   * @param {string} name The action name.\n   * @param {Action} action The action that changes the scope\n   * @throws {Error} Will throw an error if the scope frozen or action name exists in scope\n   * when it is called.\n   */\n  registerAction(name: string, action: Action<T>) {\n    if(this.isFrozen) {\n      throw new Error(`This scope is frozen you can't add new action.`);\n    }\n    if (this.actions.has(name)) {\n      throw new Error(`Action name is duplicate in scope ${this.name}`);\n    }\n    this.actions.set(name, action);\n  }\n\n  /**\n   * Dispatches an action. It is the only way to trigger a scope change.\n   * @param {string} actionName Triggered action with same name.\n   * This action change scope and return new scope.\n   * You can use resolve to change the scope or reject to throw an exception.\n   * @param {any?} props Additional data for the correct operation of the action.\n   * @return {Promise<any>} You can use the promise to get a new state of scope\n   * or catch errors.\n   * @throws {Error} Will throw an error if the actionName not present in scope.\n   */\n  dispatch(actionName: string, props?) {\n    const action: Action<T> = this.actions.get(actionName);\n    if (!action) {\n      throw new Error(`This action not exists ${actionName}`);\n    }\n    const oldScope = this.state;\n    return new Promise<T>((resolve, reject) => {\n      action(oldScope, props, resolve, reject);\n    }).then(newScope => {\n      deepFreeze(newScope);\n      this.listeners.forEach(\n        it => it({oldScope, newScope, actionName})\n      );\n      this.state = newScope;\n      return newScope;\n    });\n  }\n\n  /**\n   * Adds a scope change listener.\n   * It will be called any time an action is dispatched.\n   * @param {Listener} listener A callback to be invoked on every dispatch.\n   * By default use ROOT_SCOPE id.\n   * @return {string} A listener id to remove this change listener later.\n   */\n  subscribe(listener: Listener<T>) {\n    const listenerId = uniqueId('listener');\n    this.listeners.set(listenerId, listener);\n    return listenerId;\n  }\n\n  /**\n   * Removes a scope change listener.\n   * @param {string} id Id of the listener to delete.\n   */\n  unsubscribe(id: string) {\n    this.listeners.delete(id);\n  }\n\n  /**\n   * Prevents the addition of new actions to scope.\n   */\n  freeze() {\n    this.isFrozen = true;\n  }\n\n  /**\n   * Returns scope state.\n   * @return {any} Scope state\n   */\n  getState() {\n    return this.state;\n  }\n\n}\n\nconst scopes: Map<string, Scope> = new Map();\n\n/**\n * Create a new scope and return it.\n * @param {string} name The name of scope\n * By default generate unique name\n * @param {any} initState The initial scope state.\n * By default use empty object.\n * @return {Scope} Scope.\n * @throws {Error} Will throw an error if name of scope not unique.\n */\nexport function createScope<T = any>(name = uniqueId('scope'), initState: T = null) {\n  if (scopes.has(name)) {\n    throw new Error(`Scope name must unique`);\n  }\n  const scope = new Scope<T>(name, initState);\n  scopes.set(name, scope);\n  return scope;\n}\n\n/**\n * Returns scope.\n * @param {string} scopeName Name scope, to get the Scope.\n * @return {Scope} Scope\n */\nexport function getScope(scopeName) {\n  return Array.from(scopes.values()).find(\n    scope => scope.name === scopeName\n  );\n}\n\n/**\n * Returns all scope states.\n * @return {{string: any}} Scope states\n */\nexport function getState() {\n  const state = {};\n  scopes.forEach(scope => state[scope.name] = scope.getState());\n  return state;\n}\n\n/**\n * This scope is global\n * @type {Scope}\n */\nexport const ROOT_SCOPE = createScope('rootScope', {});\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.ts","let indexes: { [key: string]: number } = {};\n\nfunction makeSeed(length: number) {\n  const CHARACTERS = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\";\n  let seed = \"\";\n  for (let i = 0; i < length; i++)\n    seed += CHARACTERS.charAt(Math.floor(Math.random() * CHARACTERS.length));\n  return seed;\n}\n\nexport function uniqueId(name: string = 'default') {\n  indexes[name] ? ++indexes[name] : indexes[name] = 0;\n  let index = indexes[name];\n  return `${name}-${index}-${makeSeed(8)}`;\n}\n\nexport function deepFreeze<T>(obj: T) {\n  Object.getOwnPropertyNames(obj).forEach(function (key) {\n    let prop = obj[key];\n    if (typeof prop == 'object' && prop !== null) {\n      deepFreeze(prop);\n    }\n  });\n  return Object.freeze(obj);\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/utils.ts"],"sourceRoot":""}